#!/bin/bash

ERROR(){
	echo -e "\e[0;31mERROR: \e[1;37m$1,\e[0;31m Aborting...\e[0m"
	exit $2
}

WARN(){
	echo -e "\e[1;33mWARN: \e[0;37m$1\e[0m"
}

if [ -f "${WAHROOT}/usr/lib/wpm/config.wpmfunc" ]; then
	source "${WAHROOT}/usr/lib/wpm/config.wpmfunc"
else
	if [ -f "${HOME}/.local/usr/lib/wpm/config.wpmfunc" ]; then
		source "${HOME}/.local/usr/lib/wpm/wpm/config.wpmfunc"
	else
		if [ -f "${PWD}/funcs/config.wpmfunc"  ]; then
			source "${PWD}/funcs/config.wpmfunc"
		else
			ERROR "WPM configuration script not found" 1
		fi
	fi
fi

if [ -f "${WAHROOT}/usr/lib/wpm/wahmain.wpmfunc" ]; then
	SRC="${WAHROOT}/usr/lib/wpm"
	source "${WAHROOT}/usr/lib/wpm/wahmain.wpmfunc"
else
	if [ -f "${HOME}/.local/usr/lib/wpm/wahmain.wpmfunc" ]; then
		SRC="${HOME}/.local/usr/lib/wpm"
		source "${HOME}/.local/usr/lib/wpm/wahmain.wpmfunc"
	else
		if [ -f "${PWD}/funcs/wahmain.wpmfunc"  ]; then
			SRC="$PWD/funcs"
			WARN "Local mode."
			source "${PWD}/funcs/wahmain.wpmfunc"
		else
			ERROR "WPM main script not found" 1
		fi
	fi
fi
